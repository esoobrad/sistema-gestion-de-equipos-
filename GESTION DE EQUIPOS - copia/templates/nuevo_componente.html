<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Agregar Software o Componente</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='estilo.css') }}">
</head>
<body class="dark-bg text-light">
    <div class="container col-md-6 my-4">
        <h2 class="text-center mb-4">üíæ Agregar Software o Componente</h2>

        <form method="post" enctype="multipart/form-data" class="p-4 rounded shadow dark-card">
            <div class="mb-3">
                <label class="form-label">Nombre del software o componente</label>
                <input type="text" name="software" class="form-control dark-input" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Versi√≥n</label>
                <input type="text" name="version" class="form-control dark-input">
            </div>

            <!-- üî• Eliminado: N√∫mero de serie
            <div class="mb-3">
                <label class="form-label">N√∫mero de serie</label>
                <input type="text" name="numero_serie" class="form-control dark-input">
            </div>
            -->

            <h5 class="mt-4">üîë Licencia / Identificaci√≥n</h5>
            <div class="mb-3">
                <label class="form-label">ID del producto</label>
                <input type="text" name="id_producto" class="form-control dark-input">
            </div>

            <div class="mb-3">
                <label class="form-label">Llave de licencia</label>
                <input type="text" name="llave" class="form-control dark-input">
            </div>

            <h5 class="mt-4">üè¢ Proveedor</h5>
            <div class="mb-3">
                <label class="form-label">Nombre del proveedor</label>
                <input type="text" name="proveedor" class="form-control dark-input">
            </div>

            <div class="form-check">
                <input class="form-check-input" type="checkbox" name="aplica_proveedor" value="S√≠" id="aplicaProv">
                <label class="form-check-label" for="aplicaProv">Aplica proveedor</label>
            </div>

            <h5 class="mt-4">üìÖ Fechas</h5>
            <div class="mb-3">
                <label class="form-label" for="fechaCompraInput">Fecha de compra</label>
                <input type="date" name="fecha_compra" id="fechaCompraInput" class="form-control dark-input" required>
            </div>

            <div class="mb-3">
                <label class="form-label" for="fechaVencInput">Fecha de vencimiento</label>
                <input type="date" name="fecha_vencimiento" id="fechaVencInput" class="form-control dark-input">

                <div class="form-check mt-2">
                    <input class="form-check-input" type="checkbox" id="noAplicaCheckbox" name="no_aplica" onclick="toggleFechas()">
                    <label class="form-check-label" for="noAplicaCheckbox">No aplica</label>
                </div>

                <div class="form-check mt-2">
                    <input class="form-check-input" type="checkbox" id="oemCheckbox" name="oem" onclick="toggleOEM()">
                    <label class="form-check-label" for="oemCheckbox">OEM / Sin vencimiento</label>
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label">Archivo (PDF/JPG/PNG)</label>
                <input type="file" name="archivo" class="form-control dark-input">
            </div>

            <button type="submit" class="btn btn-success">Guardar</button>
            <a href="/equipo/{{ equipo_id }}" class="btn btn-secondary">Cancelar</a>
        </form>
    </div>

    <script>
    const noAplicaCheckbox = document.getElementById("noAplicaCheckbox");
    const oemCheckbox = document.getElementById("oemCheckbox");
    const fechaCompraInput = document.getElementById("fechaCompraInput");
    const fechaVencInput = document.getElementById("fechaVencInput");

    function toggleFechas() {
        // "No aplica" SOLO afecta vencimiento
        if (noAplicaCheckbox.checked) {
            oemCheckbox.checked = false;       // No pueden coexistir
            fechaVencInput.value = '';
            fechaVencInput.disabled = true;    // desactiva vencimiento
            fechaCompraInput.disabled = false; // compra activa
        } else {
            fechaVencInput.disabled = false;   // re-activa vencimiento
        }
    }

    function toggleOEM() {
        // OEM desactiva ambas fechas
        if (oemCheckbox.checked) {
            noAplicaCheckbox.checked = false;
            fechaCompraInput.value = '';
            fechaVencInput.value = '';
            fechaCompraInput.disabled = true;
            fechaVencInput.disabled = true;
        } else {
            // Si se desmarca OEM, compra vuelve activa
            fechaCompraInput.disabled = false;
            // y vencimiento depende de "No aplica"
            fechaVencInput.disabled = noAplicaCheckbox.checked;
        }
    }
    </script>
</body>
</html>
